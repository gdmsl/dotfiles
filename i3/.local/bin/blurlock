#!/bin/bash
ICON=$XDG_DATA_HOME/xlock/lock.png
TMPBG=/tmp/screen.png

# start the clock and make the window floating
alacritty --title "ttyclock" -e "mongoclock"&
sleep 0.1 && i3-msg 'floating enable'

# take the screenshot
sleep 0.1 && maim -u /tmp/screen.png

# reduce quality of screenshot and attach lock image
convert $TMPBG -scale 10% -scale 1000% $TMPBG
convert $TMPBG $ICON -gravity East -composite -matte $TMPBG

# send signal to dunst so notifications stop displaying over the lockscreen
dunstctl set-paused true

# lock
i3lock -n -i $TMPBG

# send signal to dunst so notifications restart dysplaying
dunstctl set-paused false
